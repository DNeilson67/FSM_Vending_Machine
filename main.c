#include <stdio.h> // For stdout
#include "mylib/xplatform.c" // For cross-platform xsleep() and xcls()

void goToState(void); // Prototype

// Define states (enumerated types - like ints)
enum states { IDLE, CONFIRM, SUCCESS, FAILED};
int currState = -1;

int main(void) {

	while(1) {
        xcls();
        printf("\nVending Machine Animation\n");
        printf("\nMade by: Davin Neilson - 2602119133\n");
	    printf("Terminate with Ctrl-C\n\n");
		goToState();
	}
	return 0;
}

void goToState(void) {
    int choice;
	currState++;
	switch(currState) {
		case IDLE: // IDLE
			printf(" ____________________________________________\n");
            printf("|############################################|\n");
            printf("|#|                           |##############|\n");       
            printf("|#|    1      2222    33333   |##|````````|##|\n");        
            printf("|#|  1 1     2   2       33   |##|Welcome!|##|\n");
            printf("|#|    1       22     33333   |##|Choose a|##|\n");       
            printf("|#|    1      2          33   |##|Number. |##|\n");      
            printf("|#|  11111   22222    33333   |##|________|##|\n");        
            printf("|#|===========================|##############|\n");      
            printf("|#|```````````````````````````|##############|\n");        
            printf("|#|  4   4   55555      666   |##############|\n");
            printf("|#|  4   4   5         6      |#|`````````|##|\n");
            printf("|#|  44444   55555    66666   |#| _______ |##|\n");
            printf("|#|      4       5    6   6   |#| |1|2|3| |##|\n");
            printf("|#|      4   55555     666    |#| |4|5|6| |##|\n");
            printf("|#|===========================|#| |7|8|9| |##|\n");
            printf("|#|```````````````````````````|#| ``````` |##|\n");
            printf("|#|  77777   88888    99999   |#|[=======]|##|\n");
            printf("|#|     7    8   8    9   9   |#|  _   _  |##|\n");
            printf("|#|    7      888     99999   |#| ||| ( ) |##|\n");
            printf("|#|   7      8   8        9   |#| |||  `  |##|\n");
            printf("|#|  7       88888     9999   |#|  ~      |##|\n");
            printf("|#|===========================|#|_________|##|\n");
            printf("|#|```````````````````````````|##############|\n");
            printf("|############################################|\n");
            printf("|#|||||||||||||||||||||||||||||####```````###|\n");
            printf("|#||||||||||||PUSH|||||||||||||####/|||||/###|\n");
            printf("|############################################|\n");
            printf("/////////////////////////////////////////////\n");
            printf("|________________________________|VEND|___|\n");
            printf("Choice (0/1):");
            scanf("%d", &choice);
            if (choice != 1){
                currState = -1;
            }
           break;
			
		case CONFIRM: // Rp 1000 inserted to the machine
			printf(" ____________________________________________\n");
            printf("|############################################|\n");
            printf("|#|                           |##############|\n");       
            printf("|#|    1      2222    33333   |##|````````|##|\n");        
            printf("|#|  1 1     2   2       33   |##|  No.1  |##|\n");
            printf("|#|    1       22     33333   |##| Rp1000 |##|\n");       
            printf("|#|    1      2          33   |##|Confirm?|##|\n");      
            printf("|#|  11111   22222    33333   |##|________|##|\n");        
            printf("|#|===========================|##############|\n");      
            printf("|#|```````````````````````````|##############|\n");        
            printf("|#|  4   4   55555      666   |##############|\n");
            printf("|#|  4   4   5         6      |#|`````````|##|\n");
            printf("|#|  44444   55555    66666   |#| _______ |##|\n");
            printf("|#|      4       5    6   6   |#| |1|2|3| |##|\n");
            printf("|#|      4   55555     666    |#| |4|5|6| |##|\n");
            printf("|#|===========================|#| |7|8|9| |##|\n");
            printf("|#|```````````````````````````|#| ``````` |##|\n");
            printf("|#|  77777   88888    99999   |#|[=======]|##|\n");
            printf("|#|     7    8   8    9   9   |#|  _   _  |##|\n");
            printf("|#|    7      888     99999   |#| ||| ( ) |##|\n");
            printf("|#|   7      8   8        9   |#| |||  `  |##|\n");
            printf("|#|  7       88888     9999   |#|  ~      |##|\n");
            printf("|#|===========================|#|_________|##|\n");
            printf("|#|```````````````````````````|##############|\n");
            printf("|############################################|\n");
            printf("|#|||||||||||||||||||||||||||||####```````###|\n");
            printf("|#||||||||||||PUSH|||||||||||||####/|||||/###|\n");
            printf("|############################################|\n");
            printf("/////////////////////////////////////////////\n");
            printf("|________________________________|VEND|___|\n");
            printf("Choice (0/1):");
            scanf("%d", &choice);
            if (choice != 1){
                currState = 2;
            };
			break;
			
		case SUCCESS: // Success Info
			printf(" ____________________________________________\n");
            printf("|############################################|\n");
            printf("|#|                           |##############|\n");       
            printf("|#|  XX XX    2222    33333   |##|````````|##|\n");        
            printf("|#|   X X    2   2       33   |##|Payment |##|\n");
            printf("|#|    X       22     33333   |##|Success!|##|\n");       
            printf("|#|   X X     2          33   |##|THANKS! |##|\n");      
            printf("|#|  XX XX   22222    33333   |##|________|##|\n");        
            printf("|#|===========================|##############|\n");      
            printf("|#|```````````````````````````|##############|\n");        
            printf("|#|  4   4   55555      666   |##############|\n");
            printf("|#|  4   4   5         6      |#|`````````|##|\n");
            printf("|#|  44444   55555    66666   |#| _______ |##|\n");
            printf("|#|      4       5    6   6   |#| |1|2|3| |##|\n");
            printf("|#|      4   55555     666    |#| |4|5|6| |##|\n");
            printf("|#|===========================|#| |7|8|9| |##|\n");
            printf("|#|```````````````````````````|#| ``````` |##|\n");
            printf("|#|  77777   88888    99999   |#|[=======]|##|\n");
            printf("|#|     7    8   8    9   9   |#|  _   _  |##|\n");
            printf("|#|    7      888     99999   |#| ||| ( ) |##|\n");
            printf("|#|   7      8   8        9   |#| |||  `  |##|\n");
            printf("|#|  7       88888     9999   |#|  ~      |##|\n");
            printf("|#|===========================|#|_________|##|\n");
            printf("|#|```````````````````````````|##############|\n");
            printf("|############################################|\n");
            printf("|#                             ####```````###|\n");
            printf("|#                             ####/|||||/###|\n");
            printf("|############################################|\n");
            printf("/////////////////////////////////////////////\n");
            printf("|________________________________|VEND|___|\n");
			currState = -1;
            break;
        
        case FAILED: // Failed info
            printf(" ____________________________________________\n");
            printf("|############################################|\n");
            printf("|#|                           |##############|\n");       
            printf("|#|    1      2222    33333   |##|````````|##|\n");        
            printf("|#|  1 1     2   2       33   |##| FAILED!|##|\n");
            printf("|#|    1       22     33333   |##| Please |##|\n");       
            printf("|#|    1      2          33   |##|TryAgain|##|\n");      
            printf("|#|  11111   22222    33333   |##|________|##|\n");        
            printf("|#|===========================|##############|\n");      
            printf("|#|```````````````````````````|##############|\n");        
            printf("|#|  4   4   55555      666   |##############|\n");
            printf("|#|  4   4   5         6      |#|`````````|##|\n");
            printf("|#|  44444   55555    66666   |#| _______ |##|\n");
            printf("|#|      4       5    6   6   |#| |1|2|3| |##|\n");
            printf("|#|      4   55555     666    |#| |4|5|6| |##|\n");
            printf("|#|===========================|#| |7|8|9| |##|\n");
            printf("|#|```````````````````````````|#| ``````` |##|\n");
            printf("|#|  77777   88888    99999   |#|[=======]|##|\n");
            printf("|#|     7    8   8    9   9   |#|  _   _  |##|\n");
            printf("|#|    7      888     99999   |#| ||| ( ) |##|\n");
            printf("|#|   7      8   8        9   |#| |||  `  |##|\n");
            printf("|#|  7       88888     9999   |#|  ~      |##|\n");
            printf("|#|===========================|#|_________|##|\n");
            printf("|#|```````````````````````````|##############|\n");
            printf("|############################################|\n");
            printf("|#|||||||||||||||||||||||||||||####```````###|\n");
            printf("|#||||||||||||PUSH|||||||||||||####/|||||/###|\n");
            printf("|############################################|\n");
            printf("/////////////////////////////////////////////\n");
            printf("|________________________________|VEND|___|\n");
			currState = -1;
            break;
	}
	xsleep(3000); // Time: 3 Sec
}